version: 2.1
jobs:
  test:
    working_directory: ~/propelmarketing/foundry
    shell: /bin/bash --login

    environment:
      CIRCLE_ARTIFACTS: /tmp/circleci-artifacts
      CIRCLE_TEST_REPORTS: /tmp/circleci-test-results
      PATH: ${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/node_modules/.bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin

    docker:
    - image: mastermindg/node-10-slim-phantom
      user: node

    steps:
    - checkout
    - run:
        name: Mock Test
        command: echo "Just testing this out"
  deploy:
    working_directory: ~/propelmarketing/foundry
    shell: /bin/bash --login

    docker:
    - image: mastermindg/node-10-slim-phantom
      user: node

    steps:
    - checkout
    - run:
        name: Mock Deploy
        command: echo "Deploying it"
  moretests:
    working_directory: ~/propelmarketing/foundry
    shell: /bin/bash --login

    docker:
    - image: mastermindg/node-10-slim-phantom
      user: node

    steps:
    - checkout
    - run:
        name: Mock Test
        command: echo "Testing before deploy"
        command: echo "Was the build param passed: $runit"
workflows:
  version: 2
  test:
   jobs:
     - test
     - moretests:
        filters:
          branches:
            ignore: /.*/
     - deploy:
        requires:
          - moretests
