---
version: 2.1
jobs:
  deploy:
    docker:
      -
        image: mastermindg/node-10-slim-phantom
        user: node
    shell: "/bin/bash --login"
    steps:
      - checkout
      -
        run:
          command: "echo \"Deploying it $runit\""
          name: "Mock Deploy"
    working_directory: ~/propelmarketing/foundry
  moretests:
    docker:
      -
        image: mastermindg/node-10-slim-phantom
        user: node
    shell: "/bin/bash --login"
    steps:
      - checkout
      -
        run:
          command: "echo \"Testing before deploy\""
          name: "Mock Test"
    working_directory: ~/propelmarketing/foundry
  test:
    docker:
      -
        image: mastermindg/node-10-slim-phantom
        user: node
    environment:
      CIRCLE_ARTIFACTS: /tmp/circleci-artifacts
      CIRCLE_TEST_REPORTS: /tmp/circleci-test-results
      PATH: "${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/node_modules/.bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    shell: "/bin/bash --login"
    steps:
      - checkout
      -
        run:
          command: "echo \"Just testing this out\""
          name: "Mock Test"
    working_directory: ~/propelmarketing/foundry
workflows:
  version: 2
  test:
    jobs:
      - test
      -
        deploy:
          filters:
            branches:
              ignore: /.*/
          requires:
            - test
